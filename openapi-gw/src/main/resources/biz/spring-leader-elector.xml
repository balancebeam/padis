<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
       xmlns:task="http://www.springframework.org/schema/task"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/task
        http://www.springframework.org/schema/task/spring-task-3.0.xsd">

    <bean id="leaderElector" class="com.zhongan.jobkeeper.LeaderElector"
          init-method="register" destroy-method="destroy">
        <constructor-arg name="zkConnectionString">
            <value>${za.openapi.gw.zkConnectionString}</value>
        </constructor-arg>
        <constructor-arg name="zkSessionTimeout">
            <value>${za.openapi.gw.zkSessionTimeout}</value>
        </constructor-arg>
        <constructor-arg name="ephemeralZnodeNamePrefix">
            <value>${za.openapi.gw.ephemeralZnodeNamePrefix}</value>
        </constructor-arg>
       <property name="tairManager">
            <ref bean="zaTairManager" />
        </property> 
        <property name="nameSpace">
           <value>${za.openapi.gw.tair.namespace.jobkeeper}</value>
        </property>
        <property name="keyLeader">
           <value>${za.openapi.gw.tair.key.jobkeeper.nodeTag}</value>
        </property>
    </bean>
    
    <bean id="scheduler" class="com.zhongan.jobkeeper.SingleNodeTaskScheduler">
       <property name="poolSize" value="${za.openapi.gw.poolSize}"/> 
        <property name="leaderElector" ref="leaderElector"/>
    </bean>
   
</beans>